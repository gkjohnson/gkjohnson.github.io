<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    
    <!-- favicon insanity -->
    <link rel="shortcut icon" href="./favicons/favicon.ico">
    <link rel="icon" sizes="16x16 32x32 64x64" href="./favicons/favicon.ico">
    <link rel="icon" type="image/png" sizes="196x196" href="./favicons/favicon-192.png">
    <link rel="icon" type="image/png" sizes="160x160" href="./favicons/favicon-160.png">
    <link rel="icon" type="image/png" sizes="96x96" href="./favicons/favicon-96.png">
    <link rel="icon" type="image/png" sizes="64x64" href="./favicons/favicon-64.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicons/favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicons/favicon-16.png">
    <link rel="apple-touch-icon" href="./favicons/favicon-57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="./favicons/favicon-114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./favicons/favicon-72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./favicons/favicon-144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="./favicons/favicon-60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./favicons/favicon-120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="./favicons/favicon-76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./favicons/favicon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./favicons/favicon-180.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="./favicons/favicon-144.png">
    <meta name="msapplication-config" content="./favicons/browserconfig.xml">
    <!-- end favicon insanity -->

    <title>Garrett Johnson</title>

    <!-- TODO: Host and bundle these locally -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,500" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <script type="text/javascript" src="./node_modules/@webcomponents/webcomponentsjs/webcomponents-lite.js"></script>
    <link rel="import" href="./node_modules/@polymer/polymer/polymer-element.html"/>
    <link rel="import" href="./node_modules/@polymer/polymer/lib/elements/dom-repeat.html"/>

    <link rel="import" href="./elements/sticky-element.html"/>
    <link rel="import" href="./elements/markdown-element.html"/>
    <link rel="import" href="./elements/skills-element.html"/>
    <link rel="import" href="./elements/sliding-image.html">

    <link rel="stylesheet" type="text/css" href="./styles/index.css"/>
    <link rel="stylesheet" type="text/css" href="./styles/markdown-styles.css"/>
    <link rel="stylesheet" type="text/css" href="./styles/media.css"/>

    <script type="text/javascript">
        const updateTitlePos = () => {
            const el = document.querySelector('#title .center-container')
            const ratio = document.body.scrollTop / window.innerHeight

            const lerp = (a, b, r) => a + (b - a) * r
            const pos = lerp(50, 90, ratio)
            const opacity = lerp(1, 0, ratio)
            el.style = `top: ${pos}%; opacity: ${opacity}`
        }

        const updateMenu = () => {
            const items = document.querySelectorAll('#menu li')
            const collection = []
            for (let i = 0; i < items.length; i++) {
                const menuItem = items[i]
                const approxid = menuItem.innerText.split(' ').join('-').toLowerCase()
                const target = document.querySelector(`.markdown [id*="${approxid}"]`)

                menuItem.classList.remove('active')

                collection.push({
                    menuItem,
                    top: target ? target.getBoundingClientRect().top : Infinity
                })
            }

            collection.sort((a, b) => Math.abs(a.top) - Math.abs(b.top))

            const focusItem = collection.shift(1).menuItem
            if (focusItem) focusItem.classList.add('active')

        }

        const menuSetup = () => {
            const menuContainer = document.querySelector('#menu')
            menuContainer.addEventListener('click', e => {
                const menuItem = e.target

                if (menuItem.tagName.toLowerCase() !== 'li') return

                const approxid = menuItem.innerText.split(' ').join('-').toLowerCase()
                const target = document.querySelector(`.markdown [id*="${approxid}"]`)

                if (target) {
                    const rect = target.getBoundingClientRect()
                    const scrollPos = window.pageYOffset + rect.top
                    window.scrollTo(0, scrollPos)
                }
            })
        }

        document.onreadystatechange = () => {
            if (document.readyState === 'interactive') {
                menuSetup()

                // TODO: It seems that you can "scroll" before this
                // 'interactive' event is fired...
                // requestAnimationFrame(() => document.body.scrollTop = 0)
            }

            updateTitlePos()
        }

        window.addEventListener('scroll', () => updateTitlePos())
        window.addEventListener('scroll', () => updateMenu())


    </script>
</head>
<body>
    <div id="title">

        <div class="center-container">
            <div class="content">
                <div id="name">Garrett Johnson</div>
                <div id="email">garrett.kjohnson@gmail.com</div>
            </div>
        </div>

        <sticky-element id="sticky-icon-container">
            <div id="icons">
                <div class="buffer"></div>
                <a referrer="noopener noreferrerr" target="_blank" href="https://github.com/gkjohnson" title="Github">
                    <i class="fa fa-github"></i>
                </a>
                <a referrer="noopener noreferrerr" target="_blank" href="https://www.linkedin.com/in/garrett-kjohnson/" title="LinkedIn">
                    <i class="fa fa-linkedin"></i>
                </a>
                <a referrer="noopener noreferrerr" target="_blank" href="https://www.instagram.com/gkjohnso/" title="Instagram">
                    <i class="fa fa-instagram"></i>
                </a>
            </div>
        </sticky-element>
    </div>

    <div id="content">
        <sticky-element top-offset="45">
            <ul id="menu">
                <li>Me</li>
                <li>ProtoSpace</li>
                <li>Collaborative System Analysis</li>
                <li>Sidekick</li>
                <li>Human Robotic Systems</li>
                <li>Spacecraft Sequencing</li>
                <li>Major Final Project</li>
                <li>CS174A Graphics Final</li>
                <li>CS174A Graphics Projects</li>
            </ul>
        </sticky-element>

        <div id="project-container">
            <div id="projects" class="markdown">
                <h1 id="me">Me</h1>
                <section id="about-section">
                    <div id="about-image-container">
                        <div class="buffer"></div>
                        <div id="about-image"></div>
                        <div class="buffer"></div>
                    </div>
                    <div id="about-description">
                        <markdown-element href="../projects/about.md"></markdown-element>
                    </div>
                </section>

                <h1>Professional Projects</h1>
                <markdown-element href="../projects/protospace.md"></markdown-element>
                <markdown-element href="../projects/ime.md"></markdown-element>
                <markdown-element href="../projects/sidekick.md"></markdown-element>
                <markdown-element href="../projects/hrs.md"></markdown-element>
                <markdown-element href="../projects/sequencing.md"></markdown-element>
                
                <h1>College Projects</h1>
                <markdown-element href="../projects/graphics.md"></markdown-element>
            </div>
        </div>
    </div>
    
    <div id="copyright">Garrett Johnson &copy; 2017</div>
</body>
</html>
